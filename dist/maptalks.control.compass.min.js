/*!
 * maptalks.control.compass v0.1.2
 * LICENSE : MIT
 * (c) 2016-2020 maptalks.org
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(t.maptalks=t.maptalks||{})}(this,function(t){"use strict";function e(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):function(t,e){for(var o=Object.getOwnPropertyNames(e),a=0;a<o.length;a++){var n=o[a],s=Object.getOwnPropertyDescriptor(e,n);s&&s.configurable&&void 0===t[n]&&Object.defineProperty(t,n,s)}}(t,e))}var o=function(o){function a(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,a);var e=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,o.call(this,t));return e.COMPASS="maptalks-compass",e.DIAL="maptalks-compass-dial",e.NEEDLE="maptalks-compass-needle",e.CLOCK="maptalks-compass-dial-clock",e}return e(a,o),a.prototype.buildOn=function(t){var a=this,e=this._getCompass();this._compass=e;var o=this.options.transform,n="background-color: "+this.options.backgroundColor+";cursor:pointer;";return o&&(n+=" transform: "+o+";"),maptalks.DomUtil.setStyle(this._compass,n),maptalks.DomUtil.on(e,"click",function(){var t=a.getMap().getBearing(),o=t;a._showPlayer&&a._showPlayer.cancel();(a._showPlayer=maptalks.animation.Animation.animate({bearing:t},{duration:500,easing:"out"},function(t){var e=t.styles.bearing;a.getMap().setBearing(o-e)})).play()},this),e},a.prototype.onAdd=function(){this.map=this.getMap(),this.map.on("mousemove animating animatestart animateend dragrotating viewchange",this._rotateCompass,this),this._rotateCompass()},a.prototype.onRemove=function(){this.map.off("mousemove animating animatestart animateend dragrotating viewchange",this._rotateCompass,this),this._compass.remove(),delete this._deg,delete this._compass,delete this._needle,delete this.map},a.prototype._rotateCompass=function(){var t=parseInt(this.map.getBearing(),0);t<=180&&(t*=-1),t!==parseInt(this._deg,0)&&(this._deg=t,maptalks.DomUtil.setStyle(this._needle,"transform: rotate("+this._deg+"deg);"))},a.prototype._getCompass=function(){var t=this._createDivWithClassName(this.COMPASS),e=this._getDial(),o=this._getNeedle();return t.appendChild(e),t.appendChild(o),t},a.prototype._getDial=function(){for(var t=this._createDivWithClassName(this.DIAL),e=0;e<4;e++){var o=this._getClock();t.appendChild(o)}return t},a.prototype._getClock=function(){return this._createDivWithClassName(this.CLOCK)},a.prototype._getNeedle=function(){var t=this._createDivWithClassName(this.NEEDLE);return this._needle=t},a.prototype._createDivWithClassName=function(t){return maptalks.DomUtil.createEl("div",t)},a}(maptalks.control.Control);o.mergeOptions({position:"top-right",backgroundColor:"#172029",transform:""}),t.CompassControl=o,Object.defineProperty(t,"__esModule",{value:!0}),"undefined"!=typeof console&&console.log("maptalks.control.compass v0.1.2")});